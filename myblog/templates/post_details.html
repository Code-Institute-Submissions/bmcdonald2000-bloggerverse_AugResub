<!-- Extends the base template -->
{% extends 'base.html' %}

<!-- Template title "|title" ensure first letter is capitalised -->
{% block title%} {{ post.title|title }}{% endblock %}

<!-- Template content -->
{% block content %}
    <br/>
    <!-- The post summary clicked on by the user will be displayed in full-->
    <!-- page header -->
    <h1>{{ post.title|title }}</h1>
    <!-- author details and date appears in small font -->
    <small>By:
        {{ post.author.first_name|title }} 
        {{ post.author.last_name|title }}
        - {{ post.date }}
        <br/> 
        <!-- Logged in user can edit and delete their own posts --> 
        {% if user.is_authenticated %}
            {% if user.id == Post.author.id %}
                <a href="{% url 'edit' Post.pk %}" target="_blank">Edit</a> |
                <a href="{% url 'delete' Post.pk %}" target="_blank">Delete</a>
            {% endif %}
        {% endif %}
        <hr>
        <!-- If an image is uploaded witht he post, this will also be displayed -->
        {% if post.image %}
            <img src="{{ post.image.url }}" width="300px" height="300px">
            <br><br/>
        {% endif %}
        {{ post.body|safe }}

        <br><br/>
        <!-- Home button -->
        <a href="{% url 'home' %}"><button class="btn btn-info" style="background-color: #e5c6a0; border: #e5c6a0; color: #000000;"><i class="bi bi-arrow-left" alt="" width="80" height="24" class="d-inline-block align-text-top"></i> Back</button></a>
        
        <br><br/>
        <hr>
        <br/>
        <form action="{% url 'like' post.pk %}" method="POST">
            {% csrf_token %}
            <!-- The logged in users are able to like posts, once liked they are able to dislike -->
            {% if user.is_authenticated %}
                {% if liked %}
                        <button type="submit", class= "btn btn-danger btn-sm", name= "like_id", value="{{ post.id }}">Dislike</button>
                {% else %}
                        <button type="submit", class= "btn btn-primary btn-sm", name= "like_id", value="{{ post.id }}">Like</button> 
                {% endif %}
            {% else %} 
                <!-- If a user is viewing the post but hasn't logged in they would be prompted to do so -->
                <small> <a href="{% url 'login' %}" target="_blank">login</a> to like this post</small> 
            {% endif %}
            <!-- The number of likes are displayed below each post -->
            - {{ num_likes }} likes
        </form>
        <br><br/>
        <h2>Comments</h2>
        <!-- The user is prompted to leave a comment if there are no comments -->
        {% if not post.comments.all %}
    
            No comments yet, be the first to <a href="{% url 'add_comment' post.pk %}" target="_blank">add one</a>
    
        {% else %}
        <!-- When a post has comments they will all be displayed below the post-->
            {% for comment in post.comments.all %}
                <br/>
                {{ comment.body }}
                <br/>
                <small><strong>{{ comment.name }} - {{ comment.date }}</strong></small>
            {% endfor %}
            <br><br/>
            <!-- All users will be able to add there own comments -->
            <a href="{% url 'add_comment' post.pk %}" target="_blank" >Add a comment</a>
        {% endif %}
        <hr>
        <br/>
{% endblock %}